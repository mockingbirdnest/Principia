syntax = "proto2";

import "google/protobuf/descriptor.proto";

package principia.journal.serialization;

// Encoding of string-like fields.
enum Encoding {
  UTF_8 = 1;  // Represented as "char const*" in C++ code.
  UTF_16 = 2;  // Represented as "char16_t const*" in C++ code.
}

// These two messages must come first because the other interchange messages use
// them and we need to generate the structs in the correct order.
message NavigationFrameParameters {
  required int32 extension = 1;  // 6000 to 6999, see DynamicFrame.
  required int32 centre_index = 2;
  required int32 primary_index = 3;
  required int32 secondary_index = 4;
}

message XYZ {
  required double x = 1;
  required double y = 2;
  required double z = 3;
}

message AdaptiveStepParameters {
  // Corresponds to AdaptiveStepSizeIntegrator.Kind.
  required int64 integrator_kind = 4;
  required int64 max_steps = 1;
  required double length_integration_tolerance = 2;
  required double speed_integration_tolerance = 3;
}

message BodyGeopotentialElement {
  required string degree = 1;
  required string order = 2;
  optional string cos = 3;
  optional string j = 5;
  required string sin = 4;
}

message BodyParameters {
  option (in_custom_marshaler) = "InBodyParametersMarshaler";
  required string name = 10;
  required string gravitational_parameter = 1;
  optional string reference_instant = 7;
  optional string min_radius = 12;
  optional string mean_radius = 2;
  optional string max_radius = 13;
  optional string axis_right_ascension = 3;
  optional string axis_declination = 4;
  optional string reference_angle = 8;
  optional string angular_frequency = 9;
  optional string reference_radius = 6;
  optional string j2 = 5;  // No parsing in C#.
  repeated BodyGeopotentialElement geopotential = 11
      [(size) = "geopotential_size"];
}

message Burn {
  required double thrust_in_kilonewtons = 1;
  required double specific_impulse_in_seconds_g0 = 2;
  required NavigationFrameParameters frame = 3;
  required double initial_time = 4;
  required XYZ delta_v = 5;
  required bool is_inertially_fixed = 6;
}

message ConfigurationAccuracyParameters {
  required string fitting_tolerance = 1;
  required string geopotential_tolerance = 2;
}

message ConfigurationFixedStepParameters {
  // Must be the name of one of the values of FixedStepSizeIntegrator.Kind.
  required string fixed_step_size_integrator = 1;
  required string integration_step_size = 2;
}

message ConfigurationAdaptiveStepParameters {
  // Must be the name of one of the values of AdaptiveStepSizeIntegrator.Kind.
  required string adaptive_step_size_integrator = 1;
  required string length_integration_tolerance = 2;
  required string speed_integration_tolerance = 3;
}

message FlightPlanAdaptiveStepParameters {
  // Corresponds to AdaptiveStepSizeIntegrator.Kind.
  required int64 integrator_kind = 4;
  required int64 generalized_integrator_kind = 5;
  required int64 max_steps = 1;
  required double length_integration_tolerance = 2;
  required double speed_integration_tolerance = 3;
}

message KeplerianElements {
  required double eccentricity = 1;
  required double semimajor_axis = 2 [default = nan];  // Optional.
  required double mean_motion = 3 [default = nan];     // Optional.
  required double inclination_in_degrees = 4;
  required double longitude_of_ascending_node_in_degrees = 5;
  required double argument_of_periapsis_in_degrees = 6;
  required double mean_anomaly = 7;
}

message NavigationManoeuvre {
  required Burn burn = 1;
  required double initial_mass_in_tonnes = 2;
  required double final_mass_in_tonnes = 3;
  required double mass_flow = 4;
  required double duration = 5;
  required double final_time = 6;
  required double time_of_half_delta_v = 7;
  required double time_to_half_delta_v = 8;
}

// Frenet trihedron at the beginning of the manœuvre.
message NavigationManoeuvreFrenetTrihedron {
  required XYZ binormal = 1;
  required XYZ normal = 2;
  required XYZ tangent = 3;
}

message Origin {
  required bool reference_part_is_at_origin = 1;
  required bool reference_part_is_unmoving = 2;
  required fixed32 reference_part_id = 3;
  required XYZ main_body_centre_in_world = 4;
}

message QP {
  required XYZ q = 1;
  required XYZ p = 2;
}

message Status {
  // A principia::base::Error, or equivalently, a google.rpc.Code.
  required int32 error = 1;
  // TODO(phl): find a way to produce strings in a struct and to interchange
  // enums.
}

message WXYZ {
  required double w = 1;
  required double x = 2;
  required double y = 3;
  required double z = 4;
}

message QPRW {
  required QP qp = 1;
  required WXYZ r = 2;
  required XYZ w = 3;
}

message XY {
  option (is_public) = true;
  required double x = 1;
  required double y = 2;
}

// The messages used within OrbitAnalysis are defined first, so that the struct
// definitions, being generated in the same order refer to already-defined
// types.
message Interval {
  required double min = 1;
  required double max = 2;
}

message OrbitalElements {
  required double sidereal_period = 1;
  required double nodal_period = 2;
  required double anomalistic_period = 3;
  required double nodal_precession = 4;
  required Interval mean_semimajor_axis = 5;
  required Interval mean_eccentricity = 6;
  required Interval mean_inclination = 7;
  required Interval mean_longitude_of_ascending_nodes = 8;
  required Interval mean_argument_of_periapsis = 9;
}

message OrbitRecurrence {
  required int32 nuo = 1;  // νₒ.
  required int32 dto = 2;  // Dᴛₒ.
  required int32 cto = 3;  // Cᴛₒ.
  required int32 number_of_revolutions = 4;
  required double equatorial_shift = 5;
  required double base_interval = 6;
  required double grid_interval = 7;
  required int32 subcycle = 8;
}

message EquatorialCrossings {
  required Interval longitudes_reduced_to_ascending_pass = 1;
  required Interval longitudes_reduced_to_descending_pass = 2;
}

message OrbitGroundTrack {
  required EquatorialCrossings equatorial_crossings = 1;
  // TODO(egg): mean solar times of the nodes.
}

message OrbitAnalysis {
  required double progress_of_next_analysis = 1;
  required int32 primary_index = 2;
  required double mission_duration = 3;
  // NOTE(egg): we currently have no support in the interface generator for
  // optional non-string fields in interchange structs.  We use separate
  // booleans to denote the presence of a value, where the boolean denoting
  // the presence of field F = f is field F_has_value = 10 + f.
  required OrbitalElements elements = 4;
  required bool elements_has_value = 14;
  required OrbitRecurrence recurrence = 5;
  required bool recurrence_has_value = 15;
  required OrbitGroundTrack ground_track = 6;
  required bool ground_track_has_value = 16;
}

message Method {
  extensions 5000 to 5999;  // Last used: 5166.
}

message AdvanceTime {
  extend Method {
    optional AdvanceTime extension = 5019;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required double t = 2;
    required double planetarium_rotation = 3;
  }
  optional In in = 1;
}

message CameraReferenceRotation {
  extend Method {
    optional CameraReferenceRotation extension = 5163;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  message Return {
    required WXYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message CatchUpLaggingVessels {
  extend Method {
    optional CatchUpLaggingVessels extension = 5120;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  message Out {
    required fixed64 collided_vessels = 1 [(pointer_to) = "Iterator",
                                           (disposable) = "DisposableIterator",
                                           (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message CelestialFromParent {
  extend Method {
    optional CelestialFromParent extension = 5026;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 celestial_index = 2;
  }
  message Return {
    required QP result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message CelestialInitialRotationInDegrees {
  extend Method {
    optional CelestialInitialRotationInDegrees extension = 5100;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 celestial_index = 2;
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message CelestialRotation {
  extend Method {
    optional CelestialRotation extension = 5098;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 index = 2;
  }
  message Return {
    required WXYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message CelestialRotationPeriod {
  extend Method {
    optional CelestialRotationPeriod extension = 5099;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 celestial_index = 2;
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message CelestialSphereRotation {
  extend Method {
    optional CelestialSphereRotation extension = 5101;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
  }
  message Return {
    required WXYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message CelestialWorldDegreesOfFreedom {
  extend Method {
    optional CelestialWorldDegreesOfFreedom extension = 5112;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 index = 2;
    required Origin origin = 5;
    required double time = 4;
  }
  message Return {
    required QP result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message ClearTargetVessel {
  extend Method {
    optional ClearTargetVessel extension = 5122;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  optional In in = 1;
}

message ClearWorldRotationalReferenceFrame {
  extend Method {
    optional ClearWorldRotationalReferenceFrame extension = 5145;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  optional In in = 1;
}

message CurrentTime {
  extend Method {
    optional CurrentTime extension = 5048;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message DeletePlugin {
  extend Method {
    optional DeletePlugin extension = 5000;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_consumed) = true];
  }
  message Out {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const"];
  }
  optional In in = 1;
  optional Out out = 2;
}

message DeleteString {
  extend Method {
    optional DeleteString extension = 5049;
  }
  message In {
    required fixed64 native_string = 1 [(pointer_to) = "char const",
                                        (is_consumed) = true];
  }
  message Out {
    required fixed64 native_string = 1 [(pointer_to) = "char const"];
  }
  optional In in = 1;
  optional Out out = 2;
}

message DeleteU16String {
  extend Method {
    optional DeleteU16String extension = 5155;
  }
  message In {
    required fixed64 native_string = 1 [(pointer_to) = "char16_t const",
                                        (is_consumed) = true];
  }
  message Out {
    required fixed64 native_string = 1 [(pointer_to) = "char16_t const"];
  }
  optional In in = 1;
  optional Out out = 2;
}

message DeserializePlugin {
  extend Method {
    optional DeserializePlugin extension = 5050;
  }
  message In {
    required string serialization = 1 [(size) = "serialization_size"];
    required fixed64 deserializer = 2
        [(pointer_to) = "PushDeserializer",
         (is_consumed_if) = "serialization->empty()"];
    required fixed64 plugin = 3 [(pointer_to) = "Plugin const"];
    required string compressor = 4;
    required string encoder = 5;
  }
  message Out {
    required fixed64 deserializer = 1
        [(pointer_to) = "PushDeserializer",
         (is_produced_if) = "!serialization->empty()"];
    required fixed64 plugin = 2 [(pointer_to) = "Plugin const",
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message EndInitialization {
  extend Method {
    optional EndInitialization extension = 5020;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  optional In in = 1;
}

// These functions form the external API of Principia; announce deprecation one
// lunation ahead, then make them return UNIMPLEMENTED.

// Not yet implemented.
// Solves a free-fall initial value problem, where the initial degrees of
// freedom and those of the result are given in world coordinates in the
// body-centred inertial frame of the body with the given index.
message ExternalFlowFreefall {
  extend Method {
    optional ExternalFlowFreefall extension = 5151;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 central_body_index = 2;
    required QP world_body_centred_initial_degrees_of_freedom = 3;
    required double t_initial = 4;
    required double t_final = 5;
  }
  message Out {
    required QP world_body_centred_final_degrees_of_freedom = 1;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Out out = 2;
  optional Return return = 3;
}

// Sets |coefficient| to the normalized geopotential coefficient of the given
// |degree| and |order| of the body with index |body_index|.
// |coefficient.x| is set to Cnm, |coefficient.y| is set to Snm.
message ExternalGeopotentialGetCoefficient {
  extend Method {
    optional ExternalGeopotentialGetCoefficient extension = 5156;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 body_index = 2;
    required int32 degree = 3;
    required int32 order = 4;
  }
  message Out {
    required XY coefficient = 1;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Out out = 2;
  optional Return return = 3;
}

// Sets |reference_radius| to the value in metres of the reference radius of
// the geopotential model for the body with index |body_index|.
// If the body does not have a geopotential model, i.e., if it is modeled as an
// isotropic sphere, the mean radius is used.
message ExternalGeopotentialGetReferenceRadius {
  extend Method {
    optional ExternalGeopotentialGetReferenceRadius extension = 5157;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 body_index = 2;
  }
  message Out {
    required double reference_radius = 1;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Out out = 2;
  optional Return return = 3;
}

// Returns the first point of the coast phase following the given manoeuvre
// which is locally nearest to the reference position, or the nearest endpoint
// if there is no local minimum.
message ExternalGetNearestPlannedCoastDegreesOfFreedom {
  extend Method {
    optional ExternalGetNearestPlannedCoastDegreesOfFreedom extension = 5152;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 central_body_index = 2;
    required string vessel_guid = 3;
    required int32 manoeuvre_index = 4;
    required XYZ world_body_centred_reference_position = 5;
  }
  message Out {
    required QP world_body_centred_nearest_degrees_of_freedom = 1;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Out out = 2;
  optional Return return = 3;
}

// End of external API.

message FlightPlanAppend {
  extend Method {
    optional FlightPlanAppend extension = 5063;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required Burn burn = 3;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanCreate {
  extend Method {
    optional FlightPlanCreate extension = 5071;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required double final_time = 3;
    required double mass_in_tonnes = 4;
  }
  optional In in = 1;
}

message FlightPlanDelete {
  extend Method {
    optional FlightPlanDelete extension = 5072;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  optional In in = 1;
}

message FlightPlanExists {
  extend Method {
    optional FlightPlanExists extension = 5074;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required bool result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetAdaptiveStepParameters {
  extend Method {
    optional FlightPlanGetAdaptiveStepParameters extension = 5079;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required FlightPlanAdaptiveStepParameters result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetActualFinalTime {
  extend Method {
    optional FlightPlanGetActualFinalTime extension = 5088;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetDesiredFinalTime {
  extend Method {
    optional FlightPlanGetDesiredFinalTime extension = 5076;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetGuidance {
  extend Method {
    optional FlightPlanGetGuidance extension = 5138;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required int32 index = 3;
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetInitialTime {
  extend Method {
    optional FlightPlanGetInitialTime extension = 5075;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetManoeuvre {
  extend Method {
    optional FlightPlanGetManoeuvre extension = 5064;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required int32 index = 3;
  }
  message Return {
    required NavigationManoeuvre result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanGetManoeuvreFrenetTrihedron {
  extend Method {
    optional FlightPlanGetManoeuvreFrenetTrihedron extension = 5127;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required int32 index = 3;
  }
  message Return {
    required NavigationManoeuvreFrenetTrihedron result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanNumberOfAnomalousManoeuvres {
  extend Method {
    optional FlightPlanNumberOfAnomalousManoeuvres extension = 5159;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required int32 result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanNumberOfManoeuvres {
  extend Method {
    optional FlightPlanNumberOfManoeuvres extension = 5038;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required int32 result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanNumberOfSegments {
  extend Method {
    optional FlightPlanNumberOfSegments extension = 5070;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required int32 result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanRemoveLast {
  extend Method {
    optional FlightPlanRemoveLast extension = 5065;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanRenderedApsides {
  extend Method {
    optional FlightPlanRenderedApsides extension = 5081;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required int32 celestial_index = 3;
    required XYZ sun_world_position = 4;
    required int32 max_points = 5;
  }
  message Out {
    required fixed64 apoapsides = 1 [(pointer_to) = "Iterator",
                                     (disposable) = "DisposableIterator",
                                     (is_produced) = true];
    required fixed64 periapsides = 2 [(pointer_to) = "Iterator",
                                      (disposable) = "DisposableIterator",
                                      (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message FlightPlanRenderedClosestApproaches {
  extend Method {
    optional FlightPlanRenderedClosestApproaches extension = 5126;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required XYZ sun_world_position = 3;
    required int32 max_points = 4;
  }
  message Out {
    required fixed64 closest_approaches = 1
        [(pointer_to) = "Iterator",
         (disposable) = "DisposableIterator",
         (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message FlightPlanRenderedNodes {
  extend Method {
    optional FlightPlanRenderedNodes extension = 5123;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required XYZ sun_world_position = 4;
    required int32 max_points = 5;
  }
  message Out {
    required fixed64 ascending = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
    required fixed64 descending = 2 [(pointer_to) = "Iterator",
                                     (disposable) = "DisposableIterator",
                                     (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message FlightPlanRenderedSegment {
  extend Method {
    optional FlightPlanRenderedSegment extension = 5069;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required XYZ sun_world_position = 3;
    required int32 index = 4;
  }
  message Return {
    required fixed64 result = 1 [(pointer_to) = "Iterator",
                                 (disposable) = "DisposableIterator",
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanReplace {
  extend Method {
    optional FlightPlanReplace extension = 5158;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required Burn burn = 3;
    required int32 index = 4;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanSetAdaptiveStepParameters {
  extend Method {
    optional FlightPlanSetAdaptiveStepParameters extension = 5080;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required FlightPlanAdaptiveStepParameters
        flight_plan_adaptive_step_parameters = 3;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message FlightPlanSetDesiredFinalTime {
  extend Method {
    optional FlightPlanSetDesiredFinalTime extension = 5067;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required double final_time = 3;
  }
  message Return {
    required Status result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message ForgetAllHistoriesBefore {
  extend Method {
    optional ForgetAllHistoriesBefore extension = 5021;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required double t = 2;
  }
  optional In in = 1;
}

message FreeVesselsAndPartsAndCollectPileUps {
  extend Method {
    optional FreeVesselsAndPartsAndCollectPileUps extension = 5111;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required double delta_t = 2;
  }
  optional In in = 1;
}

message FutureCatchUpVessel {
  extend Method {
    optional FutureCatchUpVessel extension = 5139;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required fixed64 result = 1 [(pointer_to) = "PileUpFuture",
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message FutureWaitForVesselToCatchUp {
  extend Method {
    optional FutureWaitForVesselToCatchUp extension = 5140;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed64 future = 2 [(pointer_to) = "PileUpFuture",
                                 (is_consumed) = true];
  }
  message Out {
    required fixed64 future = 1 [(pointer_to) = "PileUpFuture"];
    required fixed64 collided_vessels = 2 [(pointer_to) = "Iterator",
                                           (disposable) = "DisposableIterator",
                                           (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message GetBufferDuration {
  extend Method {
    optional GetBufferDuration extension = 5005;
  }
  message Return {
    required int32 result = 1;
  }
  optional Return return = 3;
}

message GetBufferedLogging {
  extend Method {
    optional GetBufferedLogging extension = 5006;
  }
  message Return {
    required int32 result = 1;
  }
  optional Return return = 3;
}

message GetStderrLogging {
  extend Method {
    optional GetStderrLogging extension = 5007;
  }
  message Return {
    required int32 result = 1;
  }
  optional Return return = 3;
}

message GetSuppressedLogging {
  extend Method {
    optional GetSuppressedLogging extension = 5008;
  }
  message Return {
    required int32 result = 1;
  }
  optional Return return = 3;
}

message GetVerboseLogging {
  extend Method {
    optional GetVerboseLogging extension = 5009;
  }
  message Return {
    required int32 result = 1;
  }
  optional Return return = 3;
}

message GetVersion {
  extend Method {
    optional GetVersion extension = 5078;
  }
  message Out {
    required string build_date = 1;
    required string version = 2;
  }
  optional Out out = 2;
}

message HasEncounteredApocalypse {
  extend Method {
    optional HasEncounteredApocalypse extension = 5102;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  message Out {
    required fixed64 details = 1 [(encoding) = UTF_8,
                                  (is_produced) = true];
  }
  message Return {
    required bool result = 1;
  }
  optional In in = 1;
  optional Out out = 2;
  optional Return return = 3;
}

message HasVessel {
  extend Method {
    optional HasVessel extension = 5039;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required bool result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message InitializeEphemerisParameters {
  extend Method {
    optional InitializeEphemerisParameters extension = 5148;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required ConfigurationAccuracyParameters accuracy_parameters = 2;
    required ConfigurationFixedStepParameters fixed_step_parameters = 3;
  }
  optional In in = 1;
}

message InitializeHistoryParameters {
  extend Method {
    optional InitializeHistoryParameters extension = 5149;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required ConfigurationFixedStepParameters parameters = 2;
  }
  optional In in = 1;
}

message InitializePsychohistoryParameters {
  extend Method {
    optional InitializePsychohistoryParameters extension = 5150;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required ConfigurationAdaptiveStepParameters parameters = 3;
  }
  optional In in = 1;
}

message InsertCelestialAbsoluteCartesian {
  extend Method {
    optional InsertCelestialAbsoluteCartesian extension = 5003;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required int32 celestial_index = 2;
    optional int32 parent_index = 3;
    required BodyParameters body_parameters = 16;
    required string x = 9;
    required string y = 10;
    required string z = 11;
    required string vx = 12;
    required string vy = 13;
    required string vz = 14;
  }
  optional In in = 1;
}

message InsertCelestialJacobiKeplerian {
  extend Method {
    optional InsertCelestialJacobiKeplerian extension = 5092;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required int32 celestial_index = 2;
    optional int32 parent_index = 3;
    required BodyParameters body_parameters = 16;
    optional KeplerianElements keplerian_elements = 9;
  }
  optional In in = 1;
}

message InsertOrKeepVessel {
  extend Method {
    optional InsertOrKeepVessel extension = 5022;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required string vessel_guid = 2;
    required string vessel_name = 5;
    required int32 parent_index = 3;
    required bool loaded = 4;
  }
  message Out {
    required bool inserted = 1;
  }
  optional In in = 1;
  optional Out out = 2;
}

message InsertOrKeepLoadedPart {
  extend Method {
    optional InsertOrKeepLoadedPart extension = 5113;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed32 part_id = 2;
    required string name = 8;
    required double mass_in_tonnes = 3;
    required XYZ moments_of_inertia_in_tonnes = 10;
    required WXYZ principal_axes_rotation = 11;
    required string vessel_guid = 4;
    required int32 main_body_index = 5;
    required QP main_body_world_degrees_of_freedom = 6;
    required QP part_world_degrees_of_freedom = 7;
    required WXYZ part_rotation = 12;
    required XYZ part_angular_velocity = 13;
    required double delta_t = 9;
  }
  optional In in = 1;
}

message InsertUnloadedPart {
  extend Method {
    optional InsertUnloadedPart extension = 5117;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed32 part_id = 2;
    required string name = 5;
    required string vessel_guid = 3;
    required QP from_parent = 4;
  }
  optional In in = 1;
}

message IteratorAtEnd {
  extend Method {
    optional IteratorAtEnd extension = 5083;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required bool result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorDelete {
  extend Method {
    optional IteratorDelete extension = 5084;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator",
                                   (is_consumed) = true];
  }
  message Out {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator"];
  }
  optional In in = 1;
  optional Out out = 2;
}

message IteratorGetDiscreteTrajectoryQP {
  extend Method {
    optional IteratorGetDiscreteTrajectoryQP extension = 5093;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required QP result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorGetDiscreteTrajectoryTime {
  extend Method {
    optional IteratorGetDiscreteTrajectoryTime extension = 5094;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required double result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorGetDiscreteTrajectoryXYZ {
  extend Method {
    optional IteratorGetDiscreteTrajectoryXYZ extension = 5085;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorGetRP2LinesIterator {
  extend Method {
    optional IteratorGetRP2LinesIterator extension = 5132;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required fixed64 result = 1 [(pointer_to) = "Iterator",
                                 (disposable) = "DisposableIterator",
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorGetRP2LineXY {
  extend Method {
    optional IteratorGetRP2LineXY extension = 5133;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required XY result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorGetVesselGuid {
  extend Method {
    optional IteratorGetVesselGuid extension = 5147;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required string result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message IteratorIncrement {
  extend Method {
    optional IteratorIncrement extension = 5086;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  optional In in = 1;
}

message IteratorReset {
  extend Method {
    optional IteratorReset extension = 5135;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  optional In in = 1;
}

message IteratorSize {
  extend Method {
    optional IteratorSize extension = 5087;
  }
  message In {
    required fixed64 iterator = 1 [(pointer_to) = "Iterator const",
                                   (disposable) = "DisposableIterator",
                                   (is_subject) = true];
  }
  message Return {
    required int32 result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message LogError {
  extend Method {
    optional LogError extension = 5010;
  }
  message In {
    required string file = 2;
    required int32 line = 3;
    required string text = 1;
  }
  optional In in = 1;
}

message LogFatal {
  extend Method {
    optional LogFatal extension = 5011;
  }
  message In {
    required string file = 2;
    required int32 line = 3;
    required string text = 1;
  }
  optional In in = 1;
}

message LogInfo {
  extend Method {
    optional LogInfo extension = 5012;
  }
  message In {
    required string file = 2;
    required int32 line = 3;
    required string text = 1;
  }
  optional In in = 1;
}

message LogWarning {
  extend Method {
    optional LogWarning extension = 5013;
  }
  message In {
    required string file = 2;
    required int32 line = 3;
    required string text = 1;
  }
  optional In in = 1;
}

message MonitorSetName {
  extend Method {
    optional MonitorSetName extension = 5143;
  }
  message In {
    required int32 i = 1;
    required string name = 2;
  }
  optional In in = 1;
}

message MonitorStart {
  extend Method {
    optional MonitorStart extension = 5141;
  }
  message In {
    required int32 i = 1;
  }
  optional In in = 1;
}

message MonitorStop {
  extend Method {
    optional MonitorStop extension = 5142;
  }
  message In {
    required int32 i = 1;
  }
  optional In in = 1;
}

message NavballOrientation {
  extend Method {
    optional NavballOrientation extension = 5051;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required XYZ sun_world_position = 3;
    required XYZ ship_world_position = 4;
  }
  message Return {
    required WXYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message NewPlugin {
  extend Method {
    optional NewPlugin extension = 5001;
  }
  message In {
    required string game_epoch = 1;
    required string solar_system_epoch = 2;
    required double planetarium_rotation_in_degrees = 3;
  }
  message Return {
    required fixed64 result = 1 [(pointer_to) = "Plugin",
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PartApplyIntrinsicForce {
  extend Method {
    optional PartApplyIntrinsicForce extension = 5114;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed32 part_id = 2;
    required XYZ force_in_kilonewtons = 3;
  }
  optional In in = 1;
}

message PartApplyIntrinsicForceAtPosition {
  extend Method {
    optional PartApplyIntrinsicForceAtPosition extension = 5164;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed32 part_id = 2;
    required XYZ force_in_kilonewtons = 3;
    required XYZ point_of_force_application = 4;
    required XYZ part_position = 5;
  }
  optional In in = 1;
}

message PartApplyIntrinsicTorque {
  extend Method {
    optional PartApplyIntrinsicTorque extension = 5165;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed32 part_id = 2;
    required XYZ torque_in_kilonewton_metre = 3;
  }
  optional In in = 1;
}

message PartGetActualDegreesOfFreedom {
  extend Method {
    optional PartGetActualDegreesOfFreedom extension = 5116;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required fixed32 part_id = 2;
    required Origin origin = 4;
  }
  message Return {
    required QPRW result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message PartIsLoaded {
	extend Method {
		optional PartIsLoaded extension = 5166;
	}
	message In {
		required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
		                             (is_subject) = true];
		required fixed32 part_id = 2;
	}
	message Return {
		required bool result = 1;
	}
	optional In in = 1;
	optional Return return = 3;
}

message PartSetApparentRigidMotion {
  extend Method {
    optional PartSetApparentRigidMotion extension = 5115;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required fixed32 part_id = 2;
    required QP degrees_of_freedom = 3;
    required WXYZ rotation = 5;
    required XYZ angular_velocity = 6;
    required QP main_body_degrees_of_freedom = 4;
  }
  optional In in = 1;
}

message PlanetariumCreate {
  extend Method {
    optional PlanetariumCreate extension = 5130;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required XYZ sun_world_position = 2;
    required XYZ xyz_opengl_camera_x_in_world = 3;
    required XYZ xyz_opengl_camera_y_in_world = 4;
    required XYZ xyz_opengl_camera_z_in_world = 5;
    required XYZ xyz_camera_position_in_world = 6;
    required double focal = 7;
    required double field_of_view = 8;
  }
  message Return {
    required fixed64 result = 1 [(pointer_to) = "Planetarium",
                                 (disposable) = "DisposablePlanetarium",
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PlanetariumDelete {
  extend Method {
    optional PlanetariumDelete extension = 5131;
  }
  message In {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const",
                                      (is_consumed) = true];
  }
  message Out {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const"];
  }
  optional In in = 1;
  optional Out out = 2;
}

message PlanetariumPlotCelestialTrajectoryForPsychohistory {
  extend Method {
    optional PlanetariumPlotCelestialTrajectoryForPsychohistory extension = 5161;
  }
  message In {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const",
                                      (disposable) = "DisposablePlanetarium",
                                      (is_subject) = true];
    required fixed64 plugin = 2 [(pointer_to) = "Plugin const"];
    required int32 celestial_index = 3;
    optional string vessel_guid = 4;
    required double max_history_length = 5;
  }
  message Return {
    required fixed64 rp2_lines = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PlanetariumPlotCelestialTrajectoryForPredictionOrFlightPlan {
  extend Method {
    optional PlanetariumPlotCelestialTrajectoryForPredictionOrFlightPlan extension = 5162;
  }
  message In {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const",
                                      (disposable) = "DisposablePlanetarium",
                                      (is_subject) = true];
    required fixed64 plugin = 2 [(pointer_to) = "Plugin const"];
    required int32 celestial_index = 3;
    required string vessel_guid = 4;
  }
  message Return {
    required fixed64 rp2_lines = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PlanetariumPlotFlightPlanSegment {
  extend Method {
    optional PlanetariumPlotFlightPlanSegment extension = 5137;
  }
  message In {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const",
                                      (disposable) = "DisposablePlanetarium",
                                      (is_subject) = true];
    required fixed64 plugin = 2 [(pointer_to) = "Plugin const"];
    required int32 method = 3;
    required string vessel_guid = 4;
    required int32 index = 5;
  }
  message Return {
    required fixed64 rp2_lines = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PlanetariumPlotPrediction {
  extend Method {
    optional PlanetariumPlotPrediction extension = 5136;
  }
  message In {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const",
                                      (disposable) = "DisposablePlanetarium",
                                      (is_subject) = true];
    required fixed64 plugin = 2 [(pointer_to) = "Plugin const"];
    required int32 method = 3;
    required string vessel_guid = 4;
  }
  message Return {
    required fixed64 rp2_lines = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PlanetariumPlotPsychohistory {
  extend Method {
    optional PlanetariumPlotPsychohistory extension = 5134;
  }
  message In {
    required fixed64 planetarium = 1 [(pointer_to) = "Planetarium const",
                                      (disposable) = "DisposablePlanetarium",
                                      (is_subject) = true];
    required fixed64 plugin = 2 [(pointer_to) = "Plugin const"];
    required int32 method = 3;
    required string vessel_guid = 4;
    required double max_history_length = 5;
  }
  message Return {
    required fixed64 rp2_lines = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message PrepareToReportCollisions {
  extend Method {
    optional PrepareToReportCollisions extension = 5118;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
  }
  optional In in = 1;
}

message RenderedPredictionApsides {
  extend Method {
    optional RenderedPredictionApsides extension = 5082;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required int32 celestial_index = 3;
    required XYZ sun_world_position = 4;
    required int32 max_points = 5;
  }
  message Out {
    required fixed64 apoapsides = 1 [(pointer_to) = "Iterator",
                                     (disposable) = "DisposableIterator",
                                     (is_produced) = true];
    required fixed64 periapsides = 2 [(pointer_to) = "Iterator",
                                      (disposable) = "DisposableIterator",
                                      (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message RenderedPredictionClosestApproaches {
  extend Method {
    optional RenderedPredictionClosestApproaches extension = 5125;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required XYZ sun_world_position = 3;
    required int32 max_points = 4;
  }
  message Out {
    required fixed64 closest_approaches = 1
        [(pointer_to) = "Iterator",
         (disposable) = "DisposableIterator",
         (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message RenderedPredictionNodes {
  extend Method {
    optional RenderedPredictionNodes extension = 5124;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required XYZ sun_world_position = 3;
    required int32 max_points = 4;
  }
  message Out {
    required fixed64 ascending = 1 [(pointer_to) = "Iterator",
                                    (disposable) = "DisposableIterator",
                                    (is_produced) = true];
    required fixed64 descending = 2 [(pointer_to) = "Iterator",
                                     (disposable) = "DisposableIterator",
                                     (is_produced) = true];
  }
  optional In in = 1;
  optional Out out = 2;
}

message ReportGroundCollision {
  extend Method {
    optional ReportGroundCollision extension = 5146;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required fixed32 part_id = 2;
  }
  optional In in = 1;
}

message ReportPartCollision {
  extend Method {
    optional ReportPartCollision extension = 5103;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required fixed32 part1_id = 2;
    required fixed32 part2_id = 3;
  }
  optional In in = 1;
}

message SayHello {
  extend Method {
    optional SayHello extension = 5053;
  }
  message Return {
    required string result = 1;
  }
  optional Return return = 3;
}

message SerializePlugin {
  extend Method {
    optional SerializePlugin extension = 5054;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required fixed64 serializer = 2
        [(pointer_to) = "PullSerializer",
         (is_consumed_if) = "result == nullptr"];
    required string compressor = 3;
    required string encoder = 4;
  }
  message Out {
    required fixed64 serializer = 1 [(pointer_to) = "PullSerializer",
                                     (is_produced_if) = "result != nullptr"];
  }
  message Return {
    required fixed64 result = 1 [(encoding) = UTF_8,
                                 (is_produced_if) = "result != nullptr"];
  }
  optional In in = 1;
  optional Out out = 2;
  optional Return return = 3;
}

message SetBufferDuration {
  extend Method {
    optional SetBufferDuration extension = 5014;
  }
  message In {
    required int32 seconds = 1;
  }
  optional In in = 1;
}

message SetBufferedLogging {
  extend Method {
    optional SetBufferedLogging extension = 5015;
  }
  message In {
    required int32 max_severity = 1;
  }
  optional In in = 1;
}

message SetMainBody {
  extend Method {
    optional SetMainBody extension = 5097;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required int32 index = 2;
  }
  optional In in = 1;
}

message SetPlottingFrame {
  extend Method {
    optional SetPlottingFrame extension = 5059;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required NavigationFrameParameters parameters = 2;
  }
  optional In in = 1;
}

message SetStderrLogging {
  extend Method {
    optional SetStderrLogging extension = 5016;
  }
  message In {
    required int32 min_severity = 1;
  }
  optional In in = 1;
}

message SetSuppressedLogging {
  extend Method {
    optional SetSuppressedLogging extension = 5017;
  }
  message In {
    required int32 min_severity = 1;
  }
  optional In in = 1;
}

message SetTargetVessel {
  extend Method {
    optional SetTargetVessel extension = 5121;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required string vessel_guid = 2;
    required int32 reference_body_index = 3;
  }
  optional In in = 1;
}

message SetVerboseLogging {
  option (run_conditional_compilation_symbol) = "PRINCIPIA_SET_VERBOSE_LOGGING";
  extend Method {
    optional SetVerboseLogging extension = 5018;
  }
  message In {
    required int32 level = 1;
  }
  optional In in = 1;
}

message SetWorldRotationalReferenceFrame {
  extend Method {
    optional SetWorldRotationalReferenceFrame extension = 5144;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin", (is_subject) = true];
    required int32 index = 2;
  }
  optional In in = 1;
}

message UnmanageableVesselVelocity {
  extend Method {
    optional UnmanageableVesselVelocity extension = 5128;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required QP degrees_of_freedom = 2;
    required int32 celestial_index = 3;
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message UpdateCelestialHierarchy {
  extend Method {
    optional UpdateCelestialHierarchy extension = 5025;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 celestial_index = 2;
    required int32 parent_index = 3;
  }
  optional In in = 1;
}

message UpdatePrediction {
  extend Method {
    optional UpdatePrediction extension = 5033;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  optional In in = 1;
}

message VesselBinormal {
  extend Method {
    optional VesselBinormal extension = 5055;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselFromParent {
  extend Method {
    optional VesselFromParent extension = 5034;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required int32 parent_index = 3;
    required string vessel_guid = 2;
  }
  message Return {
    required QP result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselGetPileUpTrace {
  extend Method {
    optional VesselGetPileUpTrace extension = 5999;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required fixed64 result = 1 [(encoding) = UTF_8,
                                 (is_produced) = true];
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselGetPredictionAdaptiveStepParameters {
  extend Method {
    optional VesselGetPredictionAdaptiveStepParameters extension = 5090;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required AdaptiveStepParameters adaptive_step_parameters = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselNormal {
  extend Method {
    optional VesselNormal extension = 5056;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselRefreshAnalysis {
  extend Method {
    optional VesselRefreshAnalysis extension = 5160;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required int32 primary_index = 3;
    required double mission_duration = 4;
    optional int32 revolutions_per_cycle = 5;
    optional int32 days_per_cycle = 6;
    required int32 ground_track_revolution = 7;
  }
  message Return {
    required OrbitAnalysis result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselSetPredictionAdaptiveStepParameters {
  extend Method {
    optional VesselSetPredictionAdaptiveStepParameters extension = 5091;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
    required AdaptiveStepParameters adaptive_step_parameters = 3;
  }
  optional In in = 1;
}

message VesselTangent {
  extend Method {
    optional VesselTangent extension = 5057;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

message VesselVelocity{
  extend Method {
    optional VesselVelocity extension = 5095;
  }
  message In {
    required fixed64 plugin = 1 [(pointer_to) = "Plugin const",
                                 (is_subject) = true];
    required string vessel_guid = 2;
  }
  message Return {
    required XYZ result = 1;
  }
  optional In in = 1;
  optional Return return = 3;
}

extend google.protobuf.FieldOptions {
  // For a fixed64 field (which is used to represent a pointer), gives the C++
  // designated type of the pointer.
  optional string pointer_to = 50000;

  // For a repeated message or string field that comes with a separate size
  // parameter, gives the name of the size parameter.
  optional string size = 50001;

  // For a fixed64 field, indicates whether the corresponding pointer is
  // consumed (deleted or has its ownership transferred) or produced (allocated)
  // by the interface.
  optional bool is_consumed = 50002;
  optional bool is_produced = 50003;

  // Same as above, but the consumption/production is conditional on some state
  // of the parameters.
  optional string is_consumed_if = 50004;
  optional string is_produced_if = 50005;

  // For a fixed64 field that is not consumed, indicates that it should follow
  // the Dispose pattern and gives the name of the disposable class.
  optional string disposable = 50009;

  // For a fixed64 field (which is used to represent a pointer), indicates that
  // it should be the subject in C# methods.
  optional bool is_subject = 50006;

  // For the (single) field of a return message, indicates that the actual
  // result should not be checked against the expected result.  Should only be
  // used when debugging issues with the replay.
  optional bool omit_check = 50007;

  // For a fixed64 field that is produced and denotes a string, indicates the
  // encoding and the representation.
  optional Encoding encoding = 50008;
}

extend google.protobuf.MessageOptions {
  // For an interchange message that is used as an in parameters, specifies the
  // custom marshaler to use.
  optional string in_custom_marshaler = 50011;
  // For an interchange message, specifies whether the generated C# struct
  // should be public (the default is internal).
  optional bool is_public = 50012;
  // If set, the body of the Run method is wrapped into an #ifdef for the given
  // symbol.  Useful for selectively skipping replay of some methods.
  optional string run_conditional_compilation_symbol = 50010;
}
